!function(t){t.skEasyAjax=function(a,n){var e={defaultAjaxTargetUrl:"",onStart:function(){},onComplete:function(){},onError:function(){},targetSelector:".ajax_action"},i=this;i.callBackFunction="",i.settings={};var r=t(a),a=a;i.init=function(){i.settings=t.extend({},e,n),s()},i.refresh=function(){c()};var s=function(){r.each(function(){"FORM"==t(this).prop("tagName")?t(this).bind("submit",o):t(this).bind("click",o)})},c=function(){r.each(function(){r.unbind("click",o),r.unbind("submit",o)}),r=t(i.settings.targetSelector),a=r.get(),s()},o=function(a){var n=t(a.target),e=n.data("params");if(void 0!=n.attr("data-callBack")&&(i.callBackFunction=n.attr("data-callBack")),void 0!=n.data("url"))var r=n.data("url");else var r=i.settings.defaultAjaxTargetUrl;var s={params:JSON.stringify(e)};void 0!=n.data("token")&&(s.token=n.data("token")),s.action=n.data("action"),"FORM"==n.prop("tagName")&&(a.preventDefault(),s=n.MytoJson()),i.settings.onStart(n),t.ajax({url:r,type:"post",data:s,success:function(t){i.settings.onComplete(n),u(t)},error:function(t){i.settings.onComplete(n),i.settings.onError(t)}})},u=function(a){if("object"==typeof a)var n=a;else var n=JSON.parse(a);0==n.status&&i.settings.onError(n),"function"==typeof window[i.callBackFunction]?n.callBackParams?window[i.callBackFunction](n.callBackParams):window[i.callBackFunction]():t(window).trigger(i.callBackFunction),c()};i.init()},t.fn.skEasyAjax=function(a){return this.each(function(){if(void 0==t(this).data("skEasyAjax")){var n=new t.skEasyAjax(this,a);t(this).data("skEasyAjax",n)}})}}(jQuery),jQuery.fn.MytoJson=function(t){t=jQuery.extend({},t);var a=this,n={},e={},i={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};this.build=function(t,a,n){return t[a]=n,t},this.push_counter=function(t){return void 0===e[t]&&(e[t]=0),e[t]++};var r=jQuery(this).serializeArray();return jQuery(this).find("input[type=checkbox]").each(function(){if("checked"==$(this).attr("checked")){var t=$(this),a=!1;$(r).each(function(){return this.name==t.attr("name")&&this.value==t.val()?void(a=!0):void 0}),a||r.push({name:$(this).attr("name"),value:$(this).val()})}}),jQuery.each(r,function(){for(var t,e=this.name.match(i.key),r=this.value,s=this.name;void 0!==(t=e.pop());)s=s.replace(new RegExp("\\["+t+"\\]$"),""),t.match(i.push)?r=a.build([],a.push_counter(s),r):t.match(i.fixed)?r=a.build([],t,r):t.match(i.named)&&(r=a.build({},t,r));n=jQuery.extend(!0,n,r)}),n},jQuery.fn.serializeObject=function(){var t={},a=this.serializeArray();return jQuery.each(a,function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t};
